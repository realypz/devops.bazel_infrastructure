#!/bin/bash
set -e

REPO_ROOT="${BUILD_WORKSPACE_DIRECTORY}"

# NOTE: BUILD_WORKSPACE_DIRECTORY is an environment variable when running Bazel executable.
#       https://bazel.build/docs/user-manual#running-executables

VENV_DIR=$REPO_ROOT/.venv
REQUIREMENTS_TXT=@@REQUIREMENTS_TXT@@

python3 -m venv "$VENV_DIR"
source "$VENV_DIR/bin/activate"
pip install -r "$REQUIREMENTS_TXT"

black $REPO_ROOT

deactivate
